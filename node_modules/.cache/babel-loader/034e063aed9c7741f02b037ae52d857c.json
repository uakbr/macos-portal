{"ast":null,"code":"import _defineProperty from\"C:/Users/usa/Downloads/macos-portfolio-main/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/usa/Downloads/macos-portfolio-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"C:/Users/usa/Downloads/macos-portfolio-main/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/usa/Downloads/macos-portfolio-main/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/Users/usa/Downloads/macos-portfolio-main/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/usa/Downloads/macos-portfolio-main/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from\"react\";import{connect}from\"react-redux\";import nightwind from\"nightwind/helper\";import TopBar from\"../components/menus/TopBar\";import Dock from\"../components/dock/Dock\";import Launchpad from\"../components/Launchpad\";import Window from\"../components/Window\";import Spotlight from\"../components/Spotlight\";import apps from\"../configs/apps\";import wallpapers from\"../configs/wallpapers\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Desktop=/*#__PURE__*/function(_Component){_inherits(Desktop,_Component);var _super=_createSuper(Desktop);function Desktop(_props){var _this;_classCallCheck(this,Desktop);_this=_super.call(this,_props);_this.getAppsData=function(){var showApps={},appsZ={},maxApps={},minApps={};apps.forEach(function(app){showApps=_objectSpread(_objectSpread({},showApps),{},_defineProperty({},app.id,app.show));appsZ=_objectSpread(_objectSpread({},appsZ),{},_defineProperty({},app.id,2));maxApps=_objectSpread(_objectSpread({},maxApps),{},_defineProperty({},app.id,false));minApps=_objectSpread(_objectSpread({},minApps),{},_defineProperty({},app.id,false));});_this.setState({showApps:showApps});};_this.toggleLaunchpad=function(target){var r=document.querySelector(\"#launchpad\");if(target){r.style.transform=\"scale(1)\";r.style.transition=\"ease-in 0.2s\";}else{r.style.transform=\"scale(1.1)\";r.style.transition=\"ease-out 0.2s\";}_this.setState({showLaunchpad:target});};_this.toggleSpotlight=function(){_this.setState({spotlight:!_this.state.spotlight});};_this.setWinowsPosition=function(id){var r=document.querySelector(\"#window-\".concat(id));var rect=r.getBoundingClientRect();r.style.setProperty(\"--window-transform-x\",rect.x.toFixed(1).toString()+\"px\");r.style.setProperty(\"--window-transform-y\",rect.y.toFixed(1).toString()+\"px\");};_this.closeApp=function(id){var showApps=_this.state.showApps;showApps[id]=false;_this.setState({showApps:showApps,hideDock:false});};_this.openApp=function(id){// add it to the shown app list\nvar showApps=_this.state.showApps;showApps[id]=true;// move to the top (use a maximum z-index)\nvar appsZ=_this.state.appsZ;var maxZ=_this.state.maxZ+1;appsZ[id]=maxZ;_this.setState({showApps:showApps,appsZ:appsZ,maxZ:maxZ,currentTitle:apps.find(function(app){return app.id===id;}).title});var minApps=_this.state.minApps;// if the app has already been shown but minimized\nif(minApps[id]){// move to window's last position\nvar r=document.querySelector(\"#window-\".concat(id));r.style.transform=\"translate(\".concat(r.style.getPropertyValue(\"--window-transform-x\"),\", \").concat(r.style.getPropertyValue(\"--window-transform-y\"),\") scale(1)\");r.style.transition=\"ease-in 0.3s\";// remove it from the minimized app list\nminApps[id]=false;_this.setState({minApps:minApps});}};_this.setAppMax=function(id,target){var maxApps=_this.state.maxApps;if(target===undefined)target=!maxApps[id];maxApps[id]=target;_this.setState({maxApps:maxApps,hideDock:target});};_this.setAppMin=function(id,target){var minApps=_this.state.minApps;if(target===undefined)target=!minApps[id];minApps[id]=target;_this.setState({minApps:minApps});};_this.minimizeApp=function(id){_this.setWinowsPosition(id);// get the corrosponding dock icon's position\nvar r=document.querySelector(\"#dock-\".concat(id));var dockAppRect=r.getBoundingClientRect();r=document.querySelector(\"#window-\".concat(id));var appRect=r.getBoundingClientRect();var posY=document.body.offsetHeight-appRect.y.toFixed(1)-(r.offsetHeight/2).toFixed(1);var posX=dockAppRect.x.toFixed(1)-(r.offsetWidth/2).toFixed(1)+25;// translate the window to that position\nr.style.transform=\"translate(\".concat(posX,\"px, \").concat(posY,\"px) scale(0.2)\");r.style.transition=\"ease-out 0.3s\";// add it to the minimized app list\n_this.setAppMin(id,true);};_this.renderAppWindows=function(){return apps.map(function(app){if(app.desktop&&_this.state.showApps[app.id]){var props={title:app.title,id:app.id,width:app.width,height:app.height,minWidth:app.minWidth,minHeight:app.minHeight,z:_this.state.appsZ[app.id],max:_this.state.maxApps[app.id],min:_this.state.minApps[app.id],close:_this.closeApp,setMax:_this.setAppMax,setMin:_this.minimizeApp,focus:_this.openApp};return/*#__PURE__*/_jsx(Window,_objectSpread(_objectSpread({},props),{},{children:app.content}),\"desktop-app-\".concat(app.id));}else{return/*#__PURE__*/_jsx(\"div\",{},\"desktop-app-\".concat(app.id));}});};_this.state={showApps:{},appsZ:{},maxApps:{},minApps:{},maxZ:2,showLaunchpad:false,currentTitle:\"Finder\",hideDock:false,spotlight:false,spotlightBtnRef:null};return _this;}_createClass(Desktop,[{key:\"componentDidMount\",value:function componentDidMount(){this.getAppsData();}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full h-full overflow-hidden bg-center bg-cover\",style:{backgroundImage:\"url(\".concat(this.props.dark?wallpapers.night:wallpapers.day,\")\"),filter:\"brightness( \".concat(this.props.brightness*0.7+50,\"% )\")},children:[/*#__PURE__*/_jsx(\"script\",{dangerouslySetInnerHTML:{__html:nightwind.init()}}),/*#__PURE__*/_jsx(TopBar,{title:this.state.currentTitle,setLogin:this.props.setLogin,shutMac:this.props.shutMac,sleepMac:this.props.sleepMac,restartMac:this.props.restartMac,toggleSpotlight:this.toggleSpotlight,setSpotlightBtnRef:function setSpotlightBtnRef(value){_this2.setState({spotlightBtnRef:value});}}),this.renderAppWindows(),this.state.spotlight&&/*#__PURE__*/_jsx(Spotlight,{openApp:this.openApp,toggleLaunchpad:this.toggleLaunchpad,toggleSpotlight:this.toggleSpotlight,btnRef:this.state.spotlightBtnRef}),/*#__PURE__*/_jsx(Launchpad,{show:this.state.showLaunchpad,toggleLaunchpad:this.toggleLaunchpad}),/*#__PURE__*/_jsx(Dock,{open:this.openApp,showApps:this.state.showApps,showLaunchpad:this.state.showLaunchpad,toggleLaunchpad:this.toggleLaunchpad,hide:this.state.hideDock})]});}}]);return Desktop;}(Component);var mapStateToProps=function mapStateToProps(state){return{dark:state.dark,brightness:state.brightness};};export default connect(mapStateToProps,null)(Desktop);","map":{"version":3,"sources":["C:/Users/usa/Downloads/macos-portfolio-main/src/pages/Desktop.js"],"names":["React","Component","connect","nightwind","TopBar","Dock","Launchpad","Window","Spotlight","apps","wallpapers","Desktop","props","getAppsData","showApps","appsZ","maxApps","minApps","forEach","app","id","show","setState","toggleLaunchpad","target","r","document","querySelector","style","transform","transition","showLaunchpad","toggleSpotlight","spotlight","state","setWinowsPosition","rect","getBoundingClientRect","setProperty","x","toFixed","toString","y","closeApp","hideDock","openApp","maxZ","currentTitle","find","title","getPropertyValue","setAppMax","undefined","setAppMin","minimizeApp","dockAppRect","appRect","posY","body","offsetHeight","posX","offsetWidth","renderAppWindows","map","desktop","width","height","minWidth","minHeight","z","max","min","close","setMax","setMin","focus","content","spotlightBtnRef","backgroundImage","dark","night","day","filter","brightness","__html","init","setLogin","shutMac","sleepMac","restartMac","value","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport nightwind from \"nightwind/helper\";\n\nimport TopBar from \"../components/menus/TopBar\";\nimport Dock from \"../components/dock/Dock\";\nimport Launchpad from \"../components/Launchpad\";\nimport Window from \"../components/Window\";\nimport Spotlight from \"../components/Spotlight\";\nimport apps from \"../configs/apps\";\nimport wallpapers from \"../configs/wallpapers\";\n\nclass Desktop extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showApps: {},\n      appsZ: {},\n      maxApps: {},\n      minApps: {},\n      maxZ: 2,\n      showLaunchpad: false,\n      currentTitle: \"Finder\",\n      hideDock: false,\n      spotlight: false,\n      spotlightBtnRef: null\n    };\n  }\n\n  componentDidMount() {\n    this.getAppsData();\n  }\n\n  getAppsData = () => {\n    let showApps = {},\n      appsZ = {},\n      maxApps = {},\n      minApps = {};\n\n    apps.forEach((app) => {\n      showApps = {\n        ...showApps,\n        [app.id]: app.show\n      };\n      appsZ = {\n        ...appsZ,\n        [app.id]: 2\n      };\n      maxApps = {\n        ...maxApps,\n        [app.id]: false\n      };\n      minApps = {\n        ...minApps,\n        [app.id]: false\n      };\n    });\n\n    this.setState({ showApps });\n  };\n\n  toggleLaunchpad = (target) => {\n    let r = document.querySelector(`#launchpad`);\n    if (target) {\n      r.style.transform = \"scale(1)\";\n      r.style.transition = \"ease-in 0.2s\";\n    } else {\n      r.style.transform = \"scale(1.1)\";\n      r.style.transition = \"ease-out 0.2s\";\n    }\n\n    this.setState({ showLaunchpad: target });\n  };\n\n  toggleSpotlight = () => {\n    this.setState({ spotlight: !this.state.spotlight });\n  };\n\n  setWinowsPosition = (id) => {\n    let r = document.querySelector(`#window-${id}`);\n    const rect = r.getBoundingClientRect();\n    r.style.setProperty(\n      \"--window-transform-x\",\n      rect.x.toFixed(1).toString() + \"px\"\n    );\n    r.style.setProperty(\n      \"--window-transform-y\",\n      rect.y.toFixed(1).toString() + \"px\"\n    );\n  };\n\n  closeApp = (id) => {\n    let showApps = this.state.showApps;\n    showApps[id] = false;\n    this.setState({\n      showApps: showApps,\n      hideDock: false\n    });\n  };\n\n  openApp = (id) => {\n    // add it to the shown app list\n    let showApps = this.state.showApps;\n    showApps[id] = true;\n\n    // move to the top (use a maximum z-index)\n    let appsZ = this.state.appsZ;\n    let maxZ = this.state.maxZ + 1;\n    appsZ[id] = maxZ;\n\n    this.setState({\n      showApps: showApps,\n      appsZ: appsZ,\n      maxZ: maxZ,\n      currentTitle: apps.find((app) => {\n        return app.id === id;\n      }).title\n    });\n\n    let minApps = this.state.minApps;\n    // if the app has already been shown but minimized\n    if (minApps[id]) {\n      // move to window's last position\n      var r = document.querySelector(`#window-${id}`);\n      r.style.transform = `translate(${r.style.getPropertyValue(\n        \"--window-transform-x\"\n      )}, ${r.style.getPropertyValue(\"--window-transform-y\")}) scale(1)`;\n      r.style.transition = \"ease-in 0.3s\";\n      // remove it from the minimized app list\n      minApps[id] = false;\n      this.setState({ minApps });\n    }\n  };\n\n  setAppMax = (id, target) => {\n    let maxApps = this.state.maxApps;\n    if (target === undefined) target = !maxApps[id];\n    maxApps[id] = target;\n    this.setState({\n      maxApps: maxApps,\n      hideDock: target\n    });\n  };\n\n  setAppMin = (id, target) => {\n    let minApps = this.state.minApps;\n    if (target === undefined) target = !minApps[id];\n    minApps[id] = target;\n    this.setState({\n      minApps: minApps\n    });\n  };\n\n  minimizeApp = (id) => {\n    this.setWinowsPosition(id);\n\n    // get the corrosponding dock icon's position\n    var r = document.querySelector(`#dock-${id}`);\n    const dockAppRect = r.getBoundingClientRect();\n\n    r = document.querySelector(`#window-${id}`);\n    const appRect = r.getBoundingClientRect();\n    const posY =\n      document.body.offsetHeight -\n      appRect.y.toFixed(1) -\n      (r.offsetHeight / 2).toFixed(1);\n    const posX = dockAppRect.x.toFixed(1) - (r.offsetWidth / 2).toFixed(1) + 25;\n\n    // translate the window to that position\n    r.style.transform = `translate(${posX}px, ${posY}px) scale(0.2)`;\n    r.style.transition = \"ease-out 0.3s\";\n\n    // add it to the minimized app list\n    this.setAppMin(id, true);\n  };\n\n  renderAppWindows = () => {\n    return apps.map((app) => {\n      if (app.desktop && this.state.showApps[app.id]) {\n        const props = {\n          title: app.title,\n          id: app.id,\n          width: app.width,\n          height: app.height,\n          minWidth: app.minWidth,\n          minHeight: app.minHeight,\n          z: this.state.appsZ[app.id],\n          max: this.state.maxApps[app.id],\n          min: this.state.minApps[app.id],\n          close: this.closeApp,\n          setMax: this.setAppMax,\n          setMin: this.minimizeApp,\n          focus: this.openApp\n        };\n\n        return (\n          <Window key={`desktop-app-${app.id}`} {...props}>\n            {app.content}\n          </Window>\n        );\n      } else {\n        return <div key={`desktop-app-${app.id}`} />;\n      }\n    });\n  };\n\n  render() {\n    return (\n      <div\n        className=\"w-full h-full overflow-hidden bg-center bg-cover\"\n        style={{\n          backgroundImage: `url(${\n            this.props.dark ? wallpapers.night : wallpapers.day\n          })`,\n          filter: `brightness( ${this.props.brightness * 0.7 + 50}% )`\n        }}\n      >\n        {/* Dark Model Toggler */}\n        <script dangerouslySetInnerHTML={{ __html: nightwind.init() }} />\n\n        {/* Top Menu Bar */}\n        <TopBar\n          title={this.state.currentTitle}\n          setLogin={this.props.setLogin}\n          shutMac={this.props.shutMac}\n          sleepMac={this.props.sleepMac}\n          restartMac={this.props.restartMac}\n          toggleSpotlight={this.toggleSpotlight}\n          setSpotlightBtnRef={(value) => {\n            this.setState({\n              spotlightBtnRef: value\n            });\n          }}\n        />\n\n        {/* Desktop Apps */}\n        {this.renderAppWindows()}\n\n        {/* Spotlight */}\n        {this.state.spotlight && (\n          <Spotlight\n            openApp={this.openApp}\n            toggleLaunchpad={this.toggleLaunchpad}\n            toggleSpotlight={this.toggleSpotlight}\n            btnRef={this.state.spotlightBtnRef}\n          />\n        )}\n\n        {/* Launchpad */}\n        <Launchpad\n          show={this.state.showLaunchpad}\n          toggleLaunchpad={this.toggleLaunchpad}\n        />\n\n        {/* Dock */}\n        <Dock\n          open={this.openApp}\n          showApps={this.state.showApps}\n          showLaunchpad={this.state.showLaunchpad}\n          toggleLaunchpad={this.toggleLaunchpad}\n          hide={this.state.hideDock}\n        />\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    dark: state.dark,\n    brightness: state.brightness\n  };\n};\n\nexport default connect(mapStateToProps, null)(Desktop);\n"]},"metadata":{},"sourceType":"module"}